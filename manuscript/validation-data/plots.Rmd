# R script for manuscript plots

## Spectral clustering

Read data:
```{r}
dat = read.table("spectral_output/spectral_export_PCA.csv", header=TRUE, sep=",")
str(dat)


## adding predicted labels for semi 10 dis
tmpdat = read.table("spectral_output/spectral_result_semi_10_dis.csv", header=TRUE, sep=",")
str(tmpdat)

## add column to dat
dat$pred10dis = tmpdat$X0

## adding predicted labels for semi 10 kmeans
tmpdat = read.table("spectral_output/spectral_result_semi_10_kmeans.csv", header=TRUE, sep=",")
str(tmpdat)

## add column to dat
dat$pred10k = tmpdat$X0

## adding predicted labels for semi 50 dis
tmpdat = read.table("spectral_output/spectral_result_semi_50_dis.csv", header=TRUE, sep=",")
str(tmpdat)

## add column to dat
dat$pred50dis = tmpdat$X0

## adding predicted labels for semi 50 kmeans
tmpdat = read.table("spectral_output/spectral_result_semi_50_kmeans.csv", header=TRUE, sep=",")
str(tmpdat)

## add column to dat
dat$pred50k = tmpdat$X0

## adding predicted labels for unsupervised
tmpdat = read.table("spectral_output/spectral_unsupervised_result.csv", header=TRUE, sep=",")
str(tmpdat)

## add column to dat
dat$pred.unsup = tmpdat$X0


## Data has all columns:
str(dat)
``` 

Plots:
```{r}
library(ggplot2)

p = ggplot(dat,aes(x=dimension1, y=dimension2, color=as.factor(pred10dis),shape=as.factor(label)))+geom_point(cex=4, alpha=0.65)+
   xlab("PC1") + ylab(" ")+ ggtitle("Spectral 10% labels (discretize)")+
   theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none"
  )

p2 = ggplot(dat,aes(x=dimension1, y=dimension2, color=as.factor(pred10k),shape=as.factor(label)))+geom_point(cex=4, alpha=0.65)+
   xlab("PC1") + ylab(" ")+ ggtitle("Spectral 10% labels (k-means)")+
   theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none"
  )

p3 = ggplot(dat,aes(x=dimension1, y=dimension2, color=as.factor(pred50dis),shape=as.factor(label)))+geom_point(cex=4, alpha=0.65)+
   xlab("PC1") + ylab(" ")+ ggtitle("Spectral 50% labels (discretize)")+
   theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none"
  )

p4 = ggplot(dat,aes(x=dimension1, y=dimension2, color=as.factor(pred50k),shape=as.factor(label)))+geom_point(cex=4, alpha=0.65)+
   xlab("PC1") + ylab(" ")+ ggtitle("Spectral 50% labels (k-means)")+
   theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none"
  )

p5 = ggplot(dat,aes(x=dimension1, y=dimension2, color=as.factor(pred.unsup),shape=as.factor(label)))+geom_point(cex=4, alpha=0.65)+
   xlab("PC1") + ylab("PC2")+ ggtitle("Spectral 0% labels (unsupervised)")+
   theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none"
  )

## Saving plots
pdf("spectral-10dis.pdf",width=5,height=5)
p
dev.off()

pdf("spectral-10k.pdf",width=5,height=5)
p2
dev.off()

pdf("spectral-50dis.pdf",width=5,height=5)
p3
dev.off()

pdf("spectral-50k.pdf",width=5,height=5)
p4
dev.off()

pdf("spectral-unsup.pdf",width=5,height=5)
p5
dev.off()
```